{% extends 'base.html' %}
{% block content %}
    <h1>Make Your Picks</h1>
    {% if is_bracket_valid %}
        <h3 class="bracket-valid">Your most recently saved bracket is valid.</h3>
    {% else %}
        <h3 class="bracket-invalid">Your most recently saved bracket is not valid.</h3>
    {% endif %}

    <form method="post">
        <button type="submit" name="action" value="save_picks" class="btn btn-primary">Save Picks</button>
        <button type="submit" name="action" value="clear_picks" class="btn btn-primary">Clear All Picks</button>
        <button type="submit" name="action" value="fill_in_better_seeds" class="btn btn-primary">Fill In Better Seeds</button>

        <p>Note that picks are NOT saved automatically. Each time you Save Picks</p>
        <ul>
            <li>All dropdowns will be updated to only show available teams, based on your picks in earlier rounds.</li>
            <li>Picks for later rounds will be backfilled into the associated earlier rounds.</li>
        </ul>
        <div class="bracket-grid">
            {% for game in games %}
                <div class="game-dropdown" id="game{{ game.id }}">
                    <select name="game{{ game.id }}" id="game{{ game.id }}" class="bracket-grid-select">
                        <option value=""></option>
                        {% for team_id in potential_picks_map.get(game.id, []) %}
                            {% set team = teams_dict[team_id] %}
                            <option value="{{ team.id }}" {% if user_picks.get(game.id) == team.id %} selected {% endif %}>
                                {{ team.seed }} - {{ team.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            {% endfor %}

            {% include '_shared_grid.html' %}

        </div>
    </form>
{% endblock %}